{
  "patch_id": "roundN_patch",
  "previous_patch_id": "round264_patch",
  "round": 265,
  "created_utc": "2026-02-06T00:00:00Z",
  "summary": "Add deterministic shopkeeper names to LOOK and targeting warnings, and replace the placeholder GitHub Actions workflow with a real cross-platform CMake/CTest CI run.",
  "files_changed_or_added_this_round": [
    "PATCH_MANIFEST.json",
    ".github/workflows/blank.yml",
    "src/game_look.cpp",
    "src/game_targeting.cpp",
    "src/shopkeeper_identity.hpp",
    "tests/test_main.cpp"
  ],
  "files_in_patch_zip": [
    "PATCH_MANIFEST.json",
    ".github/workflows/blank.yml",
    "CMakeLists.txt",
    "dungeon.cpp",
    "src/ai.cpp",
    "src/combat.cpp",
    "src/corridor_braid.cpp",
    "src/crafting_gen.hpp",
    "src/dungeon.cpp",
    "src/dungeon.hpp",
    "src/game.cpp",
    "src/game.hpp",
    "src/game_automove.cpp",
    "src/game_interact.cpp",
    "src/game_inventory.cpp",
    "src/game_look.cpp",
    "src/game_loop.cpp",
    "src/game_save.cpp",
    "src/game_spawn.cpp",
    "src/game_spellcasting.cpp",
    "src/game_targeting.cpp",
    "src/game_world.cpp",
    "src/overworld.hpp",
    "src/render.cpp",
    "src/scent_field.hpp",
    "src/scores.cpp",
    "src/shopkeeper_identity.hpp",
    "src/spritegen.cpp",
    "src/spritegen.hpp",
    "src/spritegen3d.cpp",
    "src/terrain_sculpt.cpp",
    "src/wards.hpp",
    "src/wfc.hpp",
    "tests/CMakeLists.txt",
    "tests/test_main.cpp"
  ],
  "notes_for_reviewer": [
    "UI: LOOK now labels shopkeepers as 'SHOPKEEPER <NAME>' using deterministic shop profile identity (without leaking during hallucination).",
    "Targeting: safety warnings now include the same shopkeeper name in protected-entity prompts.",
    "Tests: add coverage ensuring LOOK + targeting warning include the deterministic shopkeeper label.",
    "CI: replace placeholder workflow with a CMake preset build that runs unit tests on ubuntu/macos/windows with -Werror."
  ],
  "patch_notes": [
    "Expose deterministic shopkeeper identity in UI: show 'SHOPKEEPER <NAME>' in LOOK and targeting safety prompts.",
    "Add unit tests verifying shopkeeper names appear in LOOK text and targeting warning strings.",
    "Replace placeholder GitHub Actions workflow with a real CI job that configures/builds/tests using the existing CMake presets (no SDL dependency)."
  ],
  "notes": [
    "Shopkeeper names are stable across runs/floors because they are derived from the shop profile seed.",
    "CI now exercises the tests preset with warnings-as-errors enabled on all three major OS runners.",
    "New tests use a tiny synthetic dungeon to keep determinism and avoid generator flakiness."
  ]
}
